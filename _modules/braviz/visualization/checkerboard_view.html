<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>braviz.visualization.checkerboard_view &mdash; Braviz Documentation</title>
    
    <link rel="stylesheet" href="../../../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.3b',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/fold_classes.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
    <link rel="top" title="Braviz Documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body role="document">
    
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="../../../index.html">
            <img class="logo" src="../../../_static/Logo_Bravis_h.png" alt="Logo"/>
          </a></p>
          <!--
        <div class="headertitle"><a
          href="../../../index.html"> Documentation </a></div>
          -->
          <nav class="parents">
              <ol>
        <li><a href="../../../index.html"> Home </a> &raquo;</li>
          <li><a href="../../index.html"  accesskey="U"  >Module code</a> &raquo;</li>
                  </ol>
          </nav>
       </div>
    </div>


    <div class="content-wrapper">
      <div class="content">
        <div class="sidebar" id="agogo-sidebar">
            
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/Logo_Bravis_h.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for braviz.visualization.checkerboard_view</h1><div class="highlight"><pre>
<span class="c">##############################################################################</span>
<span class="c">#    Braviz, Brain Data interactive visualization                            #</span>
<span class="c">#    Copyright (C) 2014  Diego Angulo                                        #</span>
<span class="c">#                                                                            #</span>
<span class="c">#    This program is free software: you can redistribute it and/or modify    #</span>
<span class="c">#    it under the terms of the GNU Lesser General Public License as          #</span>
<span class="c">#    published by  the Free Software Foundation, either version 3 of the     #</span>
<span class="c">#    License, or (at your option) any later version.                         #</span>
<span class="c">#                                                                            #</span>
<span class="c">#    This program is distributed in the hope that it will be useful,         #</span>
<span class="c">#    but WITHOUT ANY WARRANTY; without even the implied warranty of          #</span>
<span class="c">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the           #</span>
<span class="c">#    GNU Lesser General Public License for more details.                     #</span>
<span class="c">#                                                                            #</span>
<span class="c">#    You should have received a copy of the GNU Lesser General Public License#</span>
<span class="c">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.   #</span>
<span class="c">##############################################################################</span>


<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">vtk</span>
<span class="kn">from</span> <span class="nn">vtk.qt4.QVTKRenderWindowInteractor</span> <span class="kn">import</span> <span class="n">QVTKRenderWindowInteractor</span>
<span class="kn">from</span> <span class="nn">PyQt4.QtGui</span> <span class="kn">import</span> <span class="n">QFrame</span><span class="p">,</span> <span class="n">QHBoxLayout</span>
<span class="kn">from</span> <span class="nn">PyQt4.QtCore</span> <span class="kn">import</span> <span class="n">pyqtSignal</span>

<span class="kn">from</span> <span class="nn">braviz.visualization.simple_vtk</span> <span class="kn">import</span> <span class="n">OrientationAxes</span><span class="p">,</span> <span class="n">persistentImagePlane</span><span class="p">,</span> <span class="n">get_window_level</span>
<span class="kn">from</span> <span class="nn">braviz.visualization.subject_viewer</span> <span class="kn">import</span> <span class="n">do_and_render</span>


<span class="n">__author__</span> <span class="o">=</span> <span class="s">&#39;Diego&#39;</span>


<div class="viewcode-block" id="CheckboardView"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.CheckboardView">[docs]</a><span class="k">class</span> <span class="nc">CheckboardView</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Viewer to compare two images</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">render_window_interactor</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct the viewer</span>

<span class="sd">        Args:</span>
<span class="sd">            render_window_interactor (vtkRenderWindowInteractor) : Interactor for the image plane widget</span>
<span class="sd">            reader (braviz.visualization.base_reader.BaseReader) : Braviz reader</span>
<span class="sd">            widget (QObject) : Must implement *slice_change_handle*</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iren</span> <span class="o">=</span> <span class="n">render_window_interactor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren_win</span> <span class="o">=</span> <span class="n">render_window_interactor</span><span class="o">.</span><span class="n">GetRenderWindow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">SetBackground</span><span class="p">((</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">GradientBackgroundOn</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">SetBackground2</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">SetBackground</span><span class="p">((</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">SetUseDepthPeeling</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren_win</span><span class="o">.</span><span class="n">SetMultiSamples</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren_win</span><span class="o">.</span><span class="n">AlphaBitPlanesOn</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">SetOcclusionRatio</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren_win</span><span class="o">.</span><span class="n">AddRenderer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iren</span><span class="o">.</span><span class="n">SetInteractorStyle</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkInteractorStyleTrackballCamera</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">OrientationAxes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iren</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">widget</span>

        <span class="c"># pipeline</span>
        <span class="c"># img1 -&gt; map_colors -------------- |checkboard view ---&gt; plane widget</span>
        <span class="c"># img2 -&gt; reslice -&gt;  map_colors -&gt; |</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__img2</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl1</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageMapToWindowLevelColors</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl2</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageMapToWindowLevelColors</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl1</span><span class="o">.</span><span class="n">SetOutputFormatToRGB</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl2</span><span class="o">.</span><span class="n">SetOutputFormatToRGB</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__lut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;LABEL&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">lut</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;APARC&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels1</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageMapToColors</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels2</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageMapToColors</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels1</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__lut</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels2</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__lut</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels1</span><span class="o">.</span><span class="n">SetOutputFormatToRGB</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels2</span><span class="o">.</span><span class="n">SetOutputFormatToRGB</span><span class="p">()</span>

        <span class="c"># WL : Window Level, NOM: Nominal, PT: Pass Throug (no lut)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color1_type</span> <span class="o">=</span> <span class="s">&quot;WL&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__color2_type</span> <span class="o">=</span> <span class="s">&quot;WL&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__reslice2</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageReslice</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageCheckerboard</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__current_space</span> <span class="o">=</span> <span class="s">&quot;World&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__orientation</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__divs</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__img1_params</span> <span class="o">=</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s">&quot;None&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__img2_params</span> <span class="o">=</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s">&quot;None&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__outline</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkOutlineFilter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__outline_mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__outline_mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__outline</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__outline_actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__outline_actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__outline_mapper</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">AddActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__outline_actor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_camera</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">skip_render</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_number_of_divisions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__divs</span><span class="p">,</span> <span class="n">skip_render</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">__camera_positions_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">0</span><span class="p">:</span> <span class="p">((</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="mi">157</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">130</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
        <span class="mi">2</span><span class="p">:</span> <span class="p">((</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
        <span class="mi">1</span><span class="p">:</span> <span class="p">((</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
        <span class="mi">4</span><span class="p">:</span> <span class="p">((</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
        <span class="mi">3</span><span class="p">:</span> <span class="p">((</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
        <span class="mi">5</span><span class="p">:</span> <span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">252</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
        <span class="mi">6</span><span class="p">:</span> <span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">252</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
    <span class="p">}</span>

    <span class="nd">@do_and_render</span>
<div class="viewcode-block" id="CheckboardView.reset_camera"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.CheckboardView.reset_camera">[docs]</a>    <span class="k">def</span> <span class="nf">reset_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        resets the current camera to standard locations.</span>

<span class="sd">        Args:</span>
<span class="sd">            position (int) :</span>

<span class="sd">                - 0: initial 3d view</span>
<span class="sd">                - 1: left</span>
<span class="sd">                - 2: right</span>
<span class="sd">                - 3: front</span>
<span class="sd">                - 4: back</span>
<span class="sd">                - 5: top</span>
<span class="sd">                - 6: bottom</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">focal</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">viewup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__camera_positions_dict</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>

        <span class="n">cam1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">()</span>
        <span class="n">cam1</span><span class="o">.</span><span class="n">SetFocalPoint</span><span class="p">(</span><span class="n">focal</span><span class="p">)</span>
        <span class="n">cam1</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="n">cam1</span><span class="o">.</span><span class="n">SetViewUp</span><span class="p">(</span><span class="n">viewup</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">ResetCameraClippingRange</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="CheckboardView.update_pipeline"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.CheckboardView.update_pipeline">[docs]</a>    <span class="k">def</span> <span class="nf">update_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the whole visualization pipeline</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_image_plane_widget</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">Off</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">On</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__outline</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img1</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__color1_type</span> <span class="o">==</span> <span class="s">&quot;NOM&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels1</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img1</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels1</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels1</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels1</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span><span class="o">.</span><span class="n">SetInput1Data</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels1</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__color1_type</span> <span class="o">==</span> <span class="s">&quot;WL&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl1</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img1</span><span class="p">)</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">get_window_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl1</span><span class="o">.</span><span class="n">SetWindow</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl1</span><span class="o">.</span><span class="n">SetLevel</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl1</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl1</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
                    <span class="c"># self.__plane_widget.SetInputConnection(self.__color_wl1.GetOutputPort())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl1</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span><span class="o">.</span><span class="n">SetInput1Data</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl1</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__color1_type</span> <span class="o">==</span> <span class="s">&quot;PT&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span><span class="o">.</span><span class="n">SetInput1Data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__reslice2</span><span class="o">.</span><span class="n">SetOutputOrigin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img1</span><span class="o">.</span><span class="n">GetOrigin</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__reslice2</span><span class="o">.</span><span class="n">SetOutputSpacing</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img1</span><span class="o">.</span><span class="n">GetSpacing</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__reslice2</span><span class="o">.</span><span class="n">SetOutputExtent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img1</span><span class="o">.</span><span class="n">GetExtent</span><span class="p">())</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__color2_type</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__reslice2</span><span class="o">.</span><span class="n">SetInterpolationModeToNearestNeighbor</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__reslice2</span><span class="o">.</span><span class="n">SetInterpolationModeToCubic</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__reslice2</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__outline</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img2</span><span class="p">)</span>

            <span class="c">#----------------------------------</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__color2_type</span> <span class="o">==</span> <span class="s">&quot;NOM&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels2</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img2</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels2</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels2</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels2</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__reslice2</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels2</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span><span class="o">.</span><span class="n">SetInput2Data</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__color_labels2</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__color2_type</span> <span class="o">==</span> <span class="s">&quot;WL&quot;</span><span class="p">:</span>
                <span class="n">w</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">get_window_level</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img2</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl2</span><span class="o">.</span><span class="n">SetWindow</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl2</span><span class="o">.</span><span class="n">SetLevel</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl2</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img2</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl2</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl2</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl2</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__reslice2</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl2</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span><span class="o">.</span><span class="n">SetInput2Data</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__color_wl2</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__color2_type</span> <span class="o">==</span> <span class="s">&quot;PT&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__img2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__reslice2</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span><span class="o">.</span><span class="n">SetInput2Data</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">__reslice2</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
            <span class="c"># print self.__checkboard_view.GetOutput()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
</div>
    <span class="k">def</span> <span class="nf">_create_image_plane_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates the internal vtkImagePlaneWidget</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span> <span class="o">=</span> <span class="n">persistentImagePlane</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__orientation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">SetInteractor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iren</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">GetColorMap</span><span class="p">()</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">On</span><span class="p">()</span>

            <span class="k">def</span> <span class="nf">slice_change_handler</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
                <span class="n">new_slice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">GetSliceIndex</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">slice_change_handle</span><span class="p">(</span><span class="n">new_slice</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">slice_change_event</span><span class="p">,</span> <span class="n">slice_change_handler</span><span class="p">)</span>

    <span class="nd">@do_and_render</span>
<div class="viewcode-block" id="CheckboardView.set_img1"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.CheckboardView.set_img1">[docs]</a>    <span class="k">def</span> <span class="nf">set_img1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subj</span><span class="p">,</span> <span class="n">img_class</span><span class="p">,</span> <span class="n">img_name</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the first image</span>

<span class="sd">        Args:</span>
<span class="sd">            subj : Subject image code</span>
<span class="sd">            img_class (str) : image class (see :meth:`braviz.visualization.subject_viewer.ImageManager.change_image_modality`)</span>
<span class="sd">            img_name (str) : image name (see :meth:`braviz.visualization.subject_viewer.ImageManager.change_image_modality`)</span>
<span class="sd">            contrast (int) : contrast for fMRI images</span>
<span class="sd">            force (bool) : if ``True`` force reloading the data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">img_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">img_class</span> <span class="o">=</span> <span class="n">img_class</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">img_name</span> <span class="o">=</span> <span class="n">img_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="n">subj</span><span class="p">,</span> <span class="n">img_class</span><span class="p">,</span> <span class="n">img_name</span><span class="p">,</span> <span class="n">contrast</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">params</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img1_params</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__img1_params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="k">if</span> <span class="n">img_class</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">img_class</span><span class="p">,</span> <span class="n">subj</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&quot;vtk&quot;</span><span class="p">,</span>
                                              <span class="n">space</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__current_space</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">img_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="n">img_class</span> <span class="o">==</span> <span class="s">&quot;LABEL&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__color1_type</span> <span class="o">=</span> <span class="s">&quot;NOM&quot;</span>
        <span class="k">elif</span> <span class="n">img_class</span> <span class="o">==</span> <span class="s">&quot;DTI&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__color1_type</span> <span class="o">=</span> <span class="s">&quot;PT&quot;</span>
        <span class="k">elif</span> <span class="n">img_class</span> <span class="o">==</span> <span class="s">&quot;IMAGE&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__color1_type</span> <span class="o">=</span> <span class="s">&quot;WL&quot;</span>
        <span class="k">elif</span> <span class="n">img_class</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_pipeline</span><span class="p">()</span>
</div>
    <span class="nd">@do_and_render</span>
<div class="viewcode-block" id="CheckboardView.set_img2"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.CheckboardView.set_img2">[docs]</a>    <span class="k">def</span> <span class="nf">set_img2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subj</span><span class="p">,</span> <span class="n">img_class</span><span class="p">,</span> <span class="n">img_name</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the second image</span>

<span class="sd">        Args:</span>
<span class="sd">            subj : Subject image code</span>
<span class="sd">            img_class (str) : image class (see :meth:`braviz.visualization.subject_viewer.ImageManager.change_image_modality`)</span>
<span class="sd">            img_name (str) : image name (see :meth:`braviz.visualization.subject_viewer.ImageManager.change_image_modality`)</span>
<span class="sd">            contrast (int) : contrast for fMRI images</span>
<span class="sd">            force (bool) : if ``True`` force reloading the data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">img_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">img_class</span> <span class="o">=</span> <span class="n">img_class</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">img_name</span> <span class="o">=</span> <span class="n">img_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="n">subj</span><span class="p">,</span> <span class="n">img_class</span><span class="p">,</span> <span class="n">img_name</span><span class="p">,</span> <span class="n">contrast</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">params</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img1_params</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__img2_params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="k">if</span> <span class="n">img_class</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__img2</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__img2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">img_class</span><span class="p">,</span> <span class="n">subj</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&quot;vtk&quot;</span><span class="p">,</span>
                                              <span class="n">space</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__current_space</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">img_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
                <span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__img2</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="n">img_class</span> <span class="o">==</span> <span class="s">&quot;LABEL&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__color2_type</span> <span class="o">=</span> <span class="s">&quot;NOM&quot;</span>
        <span class="k">elif</span> <span class="n">img_class</span> <span class="o">==</span> <span class="s">&quot;DTI&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__color2_type</span> <span class="o">=</span> <span class="s">&quot;PT&quot;</span>
        <span class="k">elif</span> <span class="n">img_class</span> <span class="o">==</span> <span class="s">&quot;IMAGE&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__color2_type</span> <span class="o">=</span> <span class="s">&quot;WL&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_pipeline</span><span class="p">()</span>
</div>
    <span class="nd">@do_and_render</span>
<div class="viewcode-block" id="CheckboardView.set_number_of_divisions"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.CheckboardView.set_number_of_divisions">[docs]</a>    <span class="k">def</span> <span class="nf">set_number_of_divisions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">divs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set number of divisions in the checkboard pattern</span>

<span class="sd">        Args:</span>
<span class="sd">            divs (int) : Number of divisions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">divs_ar</span> <span class="o">=</span> <span class="p">[</span><span class="n">divs</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
        <span class="n">divs_ar</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__orientation</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span><span class="o">.</span><span class="n">SetNumberOfDivisions</span><span class="p">(</span><span class="n">divs_ar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__divs</span> <span class="o">=</span> <span class="n">divs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__checkboard_view</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">())</span>
</div>
    <span class="nd">@do_and_render</span>
<div class="viewcode-block" id="CheckboardView.set_orientation"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.CheckboardView.set_orientation">[docs]</a>    <span class="k">def</span> <span class="nf">set_orientation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation_int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets orientation of the plane widget</span>

<span class="sd">        Args:</span>
<span class="sd">            orientation_int (int) : 0 is x, 1 is y, 2 is z</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">set_orientation</span><span class="p">(</span><span class="n">orientation_int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__orientation</span> <span class="o">=</span> <span class="n">orientation_int</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_number_of_divisions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__divs</span><span class="p">,</span> <span class="n">skip_render</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_load_test_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_img1</span><span class="p">(</span><span class="mi">119</span><span class="p">,</span> <span class="s">&quot;IMAGE&quot;</span><span class="p">,</span> <span class="s">&quot;MRI&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_img2</span><span class="p">(</span><span class="mi">119</span><span class="p">,</span> <span class="s">&quot;LABEL&quot;</span><span class="p">,</span> <span class="s">&quot;APARC&quot;</span><span class="p">)</span>

    <span class="nd">@do_and_render</span>
<div class="viewcode-block" id="CheckboardView.change_space"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.CheckboardView.change_space">[docs]</a>    <span class="k">def</span> <span class="nf">change_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_space</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change current coordinate system</span>

<span class="sd">        new_space (str) : new coordinate system, see :meth:`~braviz.readAndFilter.base_reader.BaseReader.get`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__current_space</span> <span class="o">=</span> <span class="n">new_space</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img1_params</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__img2_params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_img1</span><span class="p">(</span><span class="o">*</span><span class="n">p1</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">skip_render</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_img2</span><span class="p">(</span><span class="o">*</span><span class="n">p2</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">skip_render</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</div>
    <span class="nd">@do_and_render</span>
<div class="viewcode-block" id="CheckboardView.set_image_slice"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.CheckboardView.set_image_slice">[docs]</a>    <span class="k">def</span> <span class="nf">set_image_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_slice</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set plane widget slice</span>

<span class="sd">        Args:</span>
<span class="sd">            new_slice (int) : Index of desired slice</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">SetSliceIndex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">new_slice</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">InvokeEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">slice_change_event</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="CheckboardView.get_number_of_image_slices"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.CheckboardView.get_number_of_image_slices">[docs]</a>    <span class="k">def</span> <span class="nf">get_number_of_image_slices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the number of slices available in the current direction</span>

<span class="sd">        Returns:</span>
<span class="sd">            The number of available slices</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__plane_widget</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">img</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">dimensions</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">GetDimensions</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">dimensions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__orientation</span><span class="p">]</span>

</div></div>
<div class="viewcode-block" id="QCheckViewer"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.QCheckViewer">[docs]</a><span class="k">class</span> <span class="nc">QCheckViewer</span><span class="p">(</span><span class="n">QFrame</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps the :class:`CheckboardView` so that in can be connected to Qt applications.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">slice_changed</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs the widget</span>

<span class="sd">        Args:</span>
<span class="sd">            reader (braviz.visualization.base_reader.BaseReader) : Braviz reader</span>
<span class="sd">            parent (QObject) : Parent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">QFrame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__qwindow_interactor</span> <span class="o">=</span> <span class="n">QVTKRenderWindowInteractor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__reader</span> <span class="o">=</span> <span class="n">reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__vtk_viewer</span> <span class="o">=</span> <span class="n">CheckboardView</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__qwindow_interactor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__reader</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__qwindow_interactor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__layout</span><span class="p">)</span>

<div class="viewcode-block" id="QCheckViewer.initialize_widget"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.QCheckViewer.initialize_widget">[docs]</a>    <span class="k">def</span> <span class="nf">initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call this function **after** calling show on the widget or a parent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__qwindow_interactor</span><span class="o">.</span><span class="n">Initialize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__qwindow_interactor</span><span class="o">.</span><span class="n">Start</span><span class="p">()</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">viewer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access to internal :class:`CheckboardView` object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__vtk_viewer</span>

<div class="viewcode-block" id="QCheckViewer.slice_change_handle"><a class="viewcode-back" href="../../../library/checkboard_view.html#braviz.visualization.checkerboard_view.QCheckViewer.slice_change_handle">[docs]</a>    <span class="k">def</span> <span class="nf">slice_change_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_slice</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Emits a qt signal when the current slice is changed from vtk</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slice_changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">new_slice</span><span class="p">)</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
        </div>

        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          
                

                

                

          
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Diego Angulo.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>







        
  </body>
</html>