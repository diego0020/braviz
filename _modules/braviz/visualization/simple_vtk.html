<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>braviz.visualization.simple_vtk &mdash; Braviz Documentation</title>
    
    <link rel="stylesheet" href="../../../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.3b',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/fold_classes.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
    <link rel="top" title="Braviz Documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body role="document">
    
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="../../../index.html">
            <img class="logo" src="../../../_static/Logo_Bravis_h.png" alt="Logo"/>
          </a></p>
          <!--
        <div class="headertitle"><a
          href="../../../index.html"> Documentation </a></div>
          -->
          <nav class="parents">
              <ol>
        <li><a href="../../../index.html"> Home </a> &raquo;</li>
          <li><a href="../../index.html"  accesskey="U"  >Module code</a> &raquo;</li>
                  </ol>
          </nav>
       </div>
    </div>


    <div class="content-wrapper">
      <div class="content">
        <div class="sidebar" id="agogo-sidebar">
            
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/Logo_Bravis_h.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for braviz.visualization.simple_vtk</h1><div class="highlight"><pre>
<span></span><span class="c1">##############################################################################</span>
<span class="c1">#    Braviz, Brain Data interactive visualization                            #</span>
<span class="c1">#    Copyright (C) 2014  Diego Angulo                                        #</span>
<span class="c1">#                                                                            #</span>
<span class="c1">#    This program is free software: you can redistribute it and/or modify    #</span>
<span class="c1">#    it under the terms of the GNU Lesser General Public License as          #</span>
<span class="c1">#    published by  the Free Software Foundation, either version 3 of the     #</span>
<span class="c1">#    License, or (at your option) any later version.                         #</span>
<span class="c1">#                                                                            #</span>
<span class="c1">#    This program is distributed in the hope that it will be useful,         #</span>
<span class="c1">#    but WITHOUT ANY WARRANTY; without even the implied warranty of          #</span>
<span class="c1">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the           #</span>
<span class="c1">#    GNU Lesser General Public License for more details.                     #</span>
<span class="c1">#                                                                            #</span>
<span class="c1">#    You should have received a copy of the GNU Lesser General Public License#</span>
<span class="c1">#    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.   #</span>
<span class="c1">##############################################################################</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">vtk</span>
<span class="kn">from</span> <span class="nn">vtk</span> <span class="kn">import</span> <span class="n">vtkImagePlaneWidget</span>
<span class="kn">from</span> <span class="nn">braviz.interaction</span> <span class="kn">import</span> <span class="n">get_fiber_bundle_descriptors</span><span class="p">,</span> <span class="n">compute_volume_and_area</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;diego&#39;</span>


<span class="k">def</span> <span class="nf">_test_arrow</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A test for the arrow polydata&quot;&quot;&quot;</span>
    <span class="n">renWin</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderWindow</span><span class="p">()</span>
    <span class="n">ren</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderer</span><span class="p">()</span>
    <span class="n">ren</span><span class="o">.</span><span class="n">SetRenderWindow</span><span class="p">(</span><span class="n">renWin</span><span class="p">)</span>
    <span class="n">renWin</span><span class="o">.</span><span class="n">AddRenderer</span><span class="p">(</span><span class="n">ren</span><span class="p">)</span>
    <span class="n">renWin</span><span class="o">.</span><span class="n">SetInteractor</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderWindowInteractor</span><span class="p">())</span>
    <span class="n">renWin</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span><span class="o">.</span><span class="n">Initialize</span><span class="p">()</span>
    <span class="n">iren</span> <span class="o">=</span> <span class="n">renWin</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span>
    <span class="n">iren</span><span class="o">.</span><span class="n">SetInteractorStyle</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkInteractorStyleTrackballCamera</span><span class="p">())</span>
    <span class="n">head_sphere</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkSphereSource</span><span class="p">()</span>
    <span class="n">head_sphere</span><span class="o">.</span><span class="n">SetRadius</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">head_sphere</span><span class="o">.</span><span class="n">SetCenter</span><span class="p">(</span><span class="o">*</span><span class="n">head</span><span class="p">)</span>
    <span class="n">tail_sphere</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkSphereSource</span><span class="p">()</span>
    <span class="n">tail_sphere</span><span class="o">.</span><span class="n">SetRadius</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">tail_sphere</span><span class="o">.</span><span class="n">SetCenter</span><span class="p">(</span><span class="o">*</span><span class="n">tail</span><span class="p">)</span>
    <span class="n">head_mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">head_mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">head_sphere</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="n">tail_mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">tail_mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">tail_sphere</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="n">head_actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
    <span class="n">tail_actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
    <span class="n">head_actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">head_mapper</span><span class="p">)</span>
    <span class="n">tail_actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">tail_mapper</span><span class="p">)</span>
    <span class="n">head_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">tail_actor</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">ren</span><span class="o">.</span><span class="n">AddActor</span><span class="p">(</span><span class="n">head_actor</span><span class="p">)</span>
    <span class="n">ren</span><span class="o">.</span><span class="n">AddActor</span><span class="p">(</span><span class="n">tail_actor</span><span class="p">)</span>

    <span class="n">arrow</span> <span class="o">=</span> <span class="n">get_arrow</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">)</span>
    <span class="n">arrow_mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
    <span class="n">arrow_mapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">arrow</span><span class="p">)</span>
    <span class="n">arrow_actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
    <span class="n">arrow_actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">arrow_mapper</span><span class="p">)</span>
    <span class="n">ren</span><span class="o">.</span><span class="n">AddViewProp</span><span class="p">(</span><span class="n">arrow_actor</span><span class="p">)</span>
    <span class="n">iren</span><span class="o">.</span><span class="n">Start</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">estimate_window_level</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimates appropriate window and level values for the given image</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageHistogramStatistics</span><span class="p">()</span>
    <span class="n">hist</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="n">hist</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">xf</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">GetAutoRange</span><span class="p">()</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">xf</span> <span class="o">-</span> <span class="n">x0</span>
    <span class="n">level</span> <span class="o">=</span> <span class="p">(</span><span class="n">xf</span> <span class="o">+</span> <span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">window</span><span class="p">,</span> <span class="n">level</span>

<div class="viewcode-block" id="SimpleVtkViewer"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.SimpleVtkViewer">[docs]</a><span class="k">class</span> <span class="nc">SimpleVtkViewer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A very simple windows with vtk renderers and interactors.</span>

<span class="sd">    This class is intended for interactive work and fast prototyping. As such it is very simple and limited.</span>
<span class="sd">    For full interactive applications consider using :mod:`~braviz.visualization.subject_viewer`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialized the internal renderer, render window and intereactor&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renWin</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderWindow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iren</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkRenderWindowInteractor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iren</span><span class="o">.</span><span class="n">SetInteractorStyle</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkInteractorStyleTrackballCamera</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iren</span><span class="o">.</span><span class="n">SetRenderWindow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">renWin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renWin</span><span class="o">.</span><span class="n">AddRenderer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renWin</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
        <span class="c1"># self.renWin.Initialize()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iren</span><span class="o">.</span><span class="n">Initialize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">picker</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellPicker</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">picker</span><span class="o">.</span><span class="n">SetTolerance</span><span class="p">(</span><span class="mf">0.005</span><span class="p">)</span>
        <span class="n">cam1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">GetActiveCamera</span><span class="p">()</span>
        <span class="n">cam1</span><span class="o">.</span><span class="n">Elevation</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
        <span class="n">cam1</span><span class="o">.</span><span class="n">Azimuth</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
        <span class="n">cam1</span><span class="o">.</span><span class="n">SetViewUp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pd_actors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;call addPolyData or addImg to add data to the viewer</span><span class="se">\n</span><span class="s2"> call start to interact&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="SimpleVtkViewer.addPolyData"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.SimpleVtkViewer.addPolyData">[docs]</a>    <span class="k">def</span> <span class="nf">addPolyData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polyData</span><span class="p">,</span> <span class="n">LUT</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a poly data to the viewer, a LUT can be set.</span>

<span class="sd">        Args:</span>
<span class="sd">            polyData (vtkPolyData) : Polydata object to add to the scene</span>
<span class="sd">            LUT (vtkScalarsToColors) : A lookup table to apply to the polydata</span>

<span class="sd">        Returns:</span>
<span class="sd">            The vtkActor instance created, it may be used to change the visual properties</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">mapper</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">polyData</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">LUT</span><span class="p">:</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">UseLookupTableScalarRangeOn</span><span class="p">()</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetLookupTable</span><span class="p">(</span><span class="n">LUT</span><span class="p">)</span>
            <span class="n">mapper</span><span class="o">.</span><span class="n">SetColorModeToMapScalars</span><span class="p">()</span>
        <span class="n">actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">mapper</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">AddActor</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
        <span class="c1"># self.ren.ResetCameraClippingRange()</span>
        <span class="c1"># self.ren.ResetCamera()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pd_actors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">actor</span></div>

<div class="viewcode-block" id="SimpleVtkViewer.start"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.SimpleVtkViewer.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call this method to start the interaction, interaction can be stopped by pressing &#39;q&#39; on the main window</span>

<span class="sd">        Args:</span>
<span class="sd">            reset (bool) : If True the camera will be reset</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;press &#39;Q&#39; on viewer window to stop&quot;</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">sys</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">reset</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">ResetCameraClippingRange</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">ResetCamera</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renWin</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iren</span><span class="o">.</span><span class="n">Start</span><span class="p">()</span></div>

<div class="viewcode-block" id="SimpleVtkViewer.addImg"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.SimpleVtkViewer.addImg">[docs]</a>    <span class="k">def</span> <span class="nf">addImg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use this method to show an image inside an image plane widget.</span>

<span class="sd">        Args:</span>
<span class="sd">            img (vtkImageData) : Image</span>

<span class="sd">        Returns:</span>
<span class="sd">            The created imagePlaneWidget</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">planeWidget</span> <span class="o">=</span> <span class="n">persistentImagePlane</span><span class="p">()</span>
        <span class="n">planeWidget</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">planeWidget</span><span class="o">.</span><span class="n">SetPlaneOrientationToXAxes</span><span class="p">()</span>
        <span class="n">planeWidget</span><span class="o">.</span><span class="n">SetSlicePosition</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">planeWidget</span><span class="o">.</span><span class="n">UpdatePlacement</span><span class="p">()</span>
        <span class="n">planeWidget</span><span class="o">.</span><span class="n">DisplayTextOn</span><span class="p">()</span>
        <span class="c1"># An outline is shown for context.</span>
        <span class="n">outline</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkOutlineFilter</span><span class="p">()</span>
        <span class="n">outline</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">outlineMapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">outlineMapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">outline</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">outlineActor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">outlineActor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">outlineMapper</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">AddActor</span><span class="p">(</span><span class="n">outlineActor</span><span class="p">)</span>
        <span class="n">planeWidget</span><span class="o">.</span><span class="n">SetPicker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">picker</span><span class="p">)</span>
        <span class="n">planeWidget</span><span class="o">.</span><span class="n">SetInteractor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">renWin</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">())</span>
        <span class="n">planeWidget</span><span class="o">.</span><span class="n">PickingManagedOn</span><span class="p">()</span>
        <span class="n">planeWidget</span><span class="o">.</span><span class="n">On</span><span class="p">()</span>
        <span class="c1"># self.ren.ResetCameraClippingRange()</span>
        <span class="c1"># self.ren.ResetCamera()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">planeWidget</span></div>

<div class="viewcode-block" id="SimpleVtkViewer.clear_poly_data"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.SimpleVtkViewer.clear_poly_data">[docs]</a>    <span class="k">def</span> <span class="nf">clear_poly_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes all polydata from the viewer&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pd_actors</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ren</span><span class="o">.</span><span class="n">RemoveViewProp</span><span class="p">(</span><span class="n">actor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pd_actors</span> <span class="o">=</span> <span class="p">[]</span></div></div>


<div class="viewcode-block" id="save_ren_win_picture"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.save_ren_win_picture">[docs]</a><span class="k">def</span> <span class="nf">save_ren_win_picture</span><span class="p">(</span><span class="n">ren_win</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">magnification</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Saves an screenshot of a render window</span>

<span class="sd">    Args:</span>
<span class="sd">        ren_win (vtkRenderWindow) : Render Window</span>
<span class="sd">        file_name (str) : Path to save screenshot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ren2img</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkWindowToImageFilter</span><span class="p">()</span>
    <span class="n">ren2img</span><span class="o">.</span><span class="n">SetInput</span><span class="p">(</span><span class="n">ren_win</span><span class="p">)</span>
    <span class="n">ren2img</span><span class="o">.</span><span class="n">SetMagnification</span><span class="p">(</span><span class="n">magnification</span><span class="p">)</span>
    <span class="n">ren2img</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPNGWriter</span><span class="p">()</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">SetFileName</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">ren2img</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">Write</span><span class="p">()</span></div>


<div class="viewcode-block" id="remove_nan_from_grid"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.remove_nan_from_grid">[docs]</a><span class="k">def</span> <span class="nf">remove_nan_from_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove missing values from a grid, it is necessary in some version of vtk to avoid crash</span>

<span class="sd">    Args:</span>
<span class="sd">        grid (vtkPolyData) : Should only contain lines</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetPoints</span><span class="p">()</span>
    <span class="n">out</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">Initialize</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">GetNumberOfCells</span><span class="p">()):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetCell</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
        <span class="n">pids</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">GetPointIds</span><span class="p">()</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">pids</span><span class="o">.</span><span class="n">GetNumberOfIds</span><span class="p">()):</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="n">pids</span><span class="o">.</span><span class="n">GetId</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
            <span class="n">pt</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetPoint</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">pt</span><span class="p">)):</span>
                <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">InsertCellPoint</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">out</span><span class="o">.</span><span class="n">SetLines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span></div>


<div class="viewcode-block" id="persistentImagePlane"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.persistentImagePlane">[docs]</a><span class="k">class</span> <span class="nc">persistentImagePlane</span><span class="p">(</span><span class="n">vtkImagePlaneWidget</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A vtkImagePlaneWidget which can keep its state between calls to SetInputData.</span>

<span class="sd">    It adds a second text message showing the mm coordinates of the cursors</span>
<span class="sd">    This message can be further enhanced by using a label image and a label dictionary</span>
<span class="sd">    Additionally the values displayed in the first message can be replaced by values taken from another image, this</span>
<span class="sd">    is useful when the displayed image contains colors or other contexts that are not the main value (ex, fmri)</span>
<span class="sd">    Finally, this class generates custom events when moving the cursor and when changing the slice.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a persistent image plane</span>

<span class="sd">        Args:</span>
<span class="sd">            Orientation (int) :  x:0 , y:1, z:2&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetMarginSizeX</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetMarginSizeY</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetDisplayText</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Initialized</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Orientation</span> <span class="o">=</span> <span class="n">orientation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MiddleButton</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels_set</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels_dict</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slice_change_event</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCommand</span><span class="o">.</span><span class="n">UserEvent</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cursor_change_event</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCommand</span><span class="o">.</span><span class="n">UserEvent</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_level_change_event</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCommand</span><span class="o">.</span><span class="n">UserEvent</span> <span class="o">+</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alternative_text1</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_cursor_position</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alternative_img</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="persistentImagePlane.SetInputData"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.persistentImagePlane.SetInputData">[docs]</a>    <span class="k">def</span> <span class="nf">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the input data por the plane widget</span>

<span class="sd">        Args:</span>
<span class="sd">            img (vtkImageData) : New image data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Initialized</span><span class="p">:</span>
            <span class="n">window_level</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">old_slice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSlicePosition</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GetWindowLevel</span><span class="p">(</span><span class="n">window_level</span><span class="p">)</span>
            <span class="n">vtkImagePlaneWidget</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetSlicePosition</span><span class="p">(</span><span class="n">old_slice</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetWindowLevel</span><span class="p">(</span><span class="o">*</span><span class="n">window_level</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">InvokeEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slice_change_event</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Initialized</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">vtkImagePlaneWidget</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetPlaneOrientation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Orientation</span><span class="p">)</span>
            <span class="n">mid_slice</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">GetDimensions</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">Orientation</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetSliceIndex</span><span class="p">(</span><span class="n">mid_slice</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">InvokeEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slice_change_event</span><span class="p">)</span></div>

<div class="viewcode-block" id="persistentImagePlane.SetInteractor"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.persistentImagePlane.SetInteractor">[docs]</a>    <span class="k">def</span> <span class="nf">SetInteractor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iact</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Links the widget to an interactor</span>

<span class="sd">        Args:</span>
<span class="sd">            iact (vtkRenderWindowInteractor) : Render window interactor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initializes the second text message, and performs normal</span>
        <span class="c1"># vtkImagePlaneWidget initialization</span>

        <span class="n">vtkImagePlaneWidget</span><span class="o">.</span><span class="n">SetInteractor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iact</span><span class="p">)</span>
        <span class="n">text2</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTextActor</span><span class="p">()</span>
        <span class="n">cor</span> <span class="o">=</span> <span class="n">text2</span><span class="o">.</span><span class="n">GetPositionCoordinate</span><span class="p">()</span>
        <span class="n">cor</span><span class="o">.</span><span class="n">SetCoordinateSystemToNormalizedViewport</span><span class="p">()</span>
        <span class="n">text2</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">([</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">])</span>
        <span class="n">text2</span><span class="o">.</span><span class="n">SetInput</span><span class="p">(</span><span class="s1">&#39;probando&#39;</span><span class="p">)</span>
        <span class="n">tprop</span> <span class="o">=</span> <span class="n">text2</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span>
        <span class="n">tprop</span><span class="o">.</span><span class="n">SetJustificationToRight</span><span class="p">()</span>
        <span class="n">tprop</span><span class="o">.</span><span class="n">SetFontSize</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">text2</span><span class="o">.</span><span class="n">SetVisibility</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">mouse_interaction</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">            Handles StartInteractionEvent and InteractionEvent</span>

<span class="sd">            Displays the appropriate messages in the corner</span>
<span class="sd">            When the mouse button is pressed displays the current slice</span>
<span class="sd">            Otherwise displays the coordinates in mm, and the associated label if available</span>
<span class="sd">            The message in the left corner may be changed so that the value is taken from a second image,</span>
<span class="sd">            this is usefurl for example to display a composed fmri image but showing in the message only the z-score</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetDisplayText</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">alternative_text1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">last_cursor_position</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MiddleButton</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">InvokeEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slice_change_event</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">InvokeEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cursor_change_event</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">text2</span><span class="o">.</span><span class="n">SetVisibility</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCurrentCursorPosition</span><span class="p">()</span>
            <span class="n">img2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span> <span class="o">=</span> <span class="n">img2</span><span class="o">.</span><span class="n">GetOrigin</span><span class="p">()</span>
            <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span> <span class="o">=</span> <span class="n">img2</span><span class="o">.</span><span class="n">GetSpacing</span><span class="p">()</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">x</span>
            <span class="n">y1</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">y</span>
            <span class="n">z1</span> <span class="o">=</span> <span class="n">z0</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="n">z</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_cursor_position</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MiddleButton</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Slice: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSliceIndex</span><span class="p">()</span>
                <span class="c1"># create event, an observer can listen to this</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">InvokeEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slice_change_event</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">InvokeEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cursor_change_event</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_set</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">)</span>
                    <span class="n">message</span> <span class="o">+=</span> <span class="s1">&#39;: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">label</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alternative_text1</span><span class="p">:</span>
                    <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alternative_img</span><span class="o">.</span><span class="n">GetScalarComponentAsDouble</span><span class="p">(</span>
                        <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="n">message2</span> <span class="o">=</span> <span class="s1">&#39;( </span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1"> ) : </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">text1</span><span class="o">.</span><span class="n">SetInput</span><span class="p">(</span><span class="n">message2</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">text1</span><span class="o">.</span><span class="n">SetVisibility</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">text2</span><span class="o">.</span><span class="n">SetInput</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">end_interact</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Handles EndInteractionEvent&quot;&quot;&quot;</span>
            <span class="n">text2</span><span class="o">.</span><span class="n">SetVisibility</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alternative_text1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">text1</span><span class="o">.</span><span class="n">SetVisibility</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MiddleButton</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">def</span> <span class="nf">detect_middle_button</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Helps in detecting when the middle button is pressed&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;MiddleButtonPressEvent&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MiddleButton</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MiddleButton</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c1"># def detect_window_level_event(obj, event):</span>
        <span class="c1">#    print self.GetWindow(), self.GetLevel()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span>
            <span class="s1">&#39;MiddleButtonPressEvent&#39;</span><span class="p">,</span> <span class="n">detect_middle_button</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GetInteractor</span><span class="p">()</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span>
            <span class="s1">&#39;MiddleButtonReleaseEvent&#39;</span><span class="p">,</span> <span class="n">detect_middle_button</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s1">&#39;InteractionEvent&#39;</span><span class="p">,</span> <span class="n">mouse_interaction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s1">&#39;StartInteractionEvent&#39;</span><span class="p">,</span> <span class="n">mouse_interaction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObserver</span><span class="p">(</span><span class="s1">&#39;EndInteractionEvent&#39;</span><span class="p">,</span> <span class="n">end_interact</span><span class="p">)</span>
        <span class="c1"># self.AddObserver(&#39;WindowLevelEvent&#39;,detect_window_level_event)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text2</span> <span class="o">=</span> <span class="n">text2</span></div>

<div class="viewcode-block" id="persistentImagePlane.On"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.persistentImagePlane.On">[docs]</a>    <span class="k">def</span> <span class="nf">On</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Turn the widget on</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Adds the second text actor to the current renderer</span>
        <span class="n">vtkImagePlaneWidget</span><span class="o">.</span><span class="n">On</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ren</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCurrentRenderer</span><span class="p">()</span>
        <span class="n">ren</span><span class="o">.</span><span class="n">AddActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text2</span><span class="p">)</span>
        <span class="n">ren</span><span class="o">.</span><span class="n">Render</span><span class="p">()</span></div>

<div class="viewcode-block" id="persistentImagePlane.setLabelsLut"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.persistentImagePlane.setLabelsLut">[docs]</a>    <span class="k">def</span> <span class="nf">setLabelsLut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lut</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A lookup table can be used to translate numeric labels into text labels</span>

<span class="sd">        Args:</span>
<span class="sd">            lut (vtkLookupTable) : Lookup table</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aparc_lut</span> <span class="o">=</span> <span class="n">lut</span></div>

<div class="viewcode-block" id="persistentImagePlane.addLabels"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.persistentImagePlane.addLabels">[docs]</a>    <span class="k">def</span> <span class="nf">addLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label_img</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A second image can be used to get labels for image coordinates (ex. aparc)</span>

<span class="sd">        Args:</span>
<span class="sd">            label_img (vtkImageData) : Image to use as reference for labels</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_img</span> <span class="o">=</span> <span class="n">label_img</span>
        <span class="k">if</span> <span class="n">label_img</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels_set</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels_set</span> <span class="o">=</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="persistentImagePlane.get_label"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.persistentImagePlane.get_label">[docs]</a>    <span class="k">def</span> <span class="nf">get_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Auxiliary function to get the label in a given coordinate (in mm)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float) : x coordinate</span>
<span class="sd">            y (float) : y coordinate</span>
<span class="sd">            z (float) : z coordinate</span>

<span class="sd">        Returns:</span>
<span class="sd">            If a lookuptable is set returns the text label, otherwise the numeric label</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">img2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_img</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span> <span class="o">=</span> <span class="n">img2</span><span class="o">.</span><span class="n">GetOrigin</span><span class="p">()</span>
        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span> <span class="o">=</span> <span class="n">img2</span><span class="o">.</span><span class="n">GetSpacing</span><span class="p">()</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="n">dx</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">dy</span>
        <span class="n">z1</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="n">z0</span><span class="p">)</span> <span class="o">/</span> <span class="n">dz</span>

        <span class="n">x1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">y1</span><span class="p">))</span>
        <span class="n">z1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">z1</span><span class="p">))</span>

        <span class="n">l</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">img2</span><span class="o">.</span><span class="n">GetScalarComponentAsDouble</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_dict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">l</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_dict</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aparc_lut</span><span class="o">.</span><span class="n">GetAnnotatedValueIndex</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aparc_lut</span><span class="o">.</span><span class="n">GetAnnotation</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels_dict</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_dict</span><span class="p">[</span><span class="n">l</span><span class="p">]</span></div>

<div class="viewcode-block" id="persistentImagePlane.text1_value_from_img"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.persistentImagePlane.text1_value_from_img">[docs]</a>    <span class="k">def</span> <span class="nf">text1_value_from_img</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Text 1 value can be read from a different image than the one been shown, useful for composed images</span>

<span class="sd">        Args:</span>
<span class="sd">            img2 (vtkImageData) : Image to get values for lower left corner text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetDisplayText</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">text1</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTextActor</span><span class="p">()</span>
        <span class="n">cor</span> <span class="o">=</span> <span class="n">text1</span><span class="o">.</span><span class="n">GetPositionCoordinate</span><span class="p">()</span>
        <span class="n">cor</span><span class="o">.</span><span class="n">SetCoordinateSystemToNormalizedViewport</span><span class="p">()</span>
        <span class="n">text1</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">])</span>
        <span class="n">text1</span><span class="o">.</span><span class="n">SetInput</span><span class="p">(</span><span class="s1">&#39;probando&#39;</span><span class="p">)</span>
        <span class="n">tprop</span> <span class="o">=</span> <span class="n">text1</span><span class="o">.</span><span class="n">GetTextProperty</span><span class="p">()</span>
        <span class="n">tprop</span><span class="o">.</span><span class="n">SetJustificationToLeft</span><span class="p">()</span>
        <span class="n">tprop</span><span class="o">.</span><span class="n">SetFontSize</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
        <span class="n">text1</span><span class="o">.</span><span class="n">SetVisibility</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alternative_text1</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alternative_img</span> <span class="o">=</span> <span class="n">img2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text1</span> <span class="o">=</span> <span class="n">text1</span>
        <span class="n">ren</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCurrentRenderer</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ren</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ren</span><span class="o">.</span><span class="n">AddActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text1</span><span class="p">)</span></div>

<div class="viewcode-block" id="persistentImagePlane.text1_to_std"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.persistentImagePlane.text1_to_std">[docs]</a>    <span class="k">def</span> <span class="nf">text1_to_std</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Turn text1 behaviour back to standard, reverts the effects of text1_value_from_img</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">alternative_text1</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">ren</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetCurrentRenderer</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ren</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ren</span><span class="o">.</span><span class="n">RemoveActor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetDisplayText</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alternative_text1</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alternative_img</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text1</span> <span class="o">=</span> <span class="bp">None</span></div>

<div class="viewcode-block" id="persistentImagePlane.set_orientation"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.persistentImagePlane.set_orientation">[docs]</a>    <span class="k">def</span> <span class="nf">set_orientation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets image plane orientation</span>

<span class="sd">        Args:</span>
<span class="sd">            orientation (int)  :  x:0 , y:1, z:2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Orientation</span> <span class="o">=</span> <span class="n">orientation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetPlaneOrientation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Orientation</span><span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">image</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">mid_slice</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">GetDimensions</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">Orientation</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSliceIndex</span><span class="p">(</span><span class="n">mid_slice</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InvokeEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slice_change_event</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="OutlineActor"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.OutlineActor">[docs]</a><span class="k">class</span> <span class="nc">OutlineActor</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;A simple shortcut for displaying the outline of an object</span>

<span class="sd">    Encapsulates an outline filter, a mapper and an actor&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates internal mapper, and filter, and performs the connections</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">outline</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkOutlineFilter</span><span class="p">()</span>

        <span class="n">outlineMapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">outlineMapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">outline</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">outlineMapper</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outline</span> <span class="o">=</span> <span class="n">outline</span>

<div class="viewcode-block" id="OutlineActor.set_input_data"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.OutlineActor.set_input_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_input_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the input data for the outline</span>

<span class="sd">        Args:</span>
<span class="sd">            input_data (vtkDataObject) : Object whose outline we want</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span></div>

<div class="viewcode-block" id="OutlineActor.SetInputData"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.OutlineActor.SetInputData">[docs]</a>    <span class="k">def</span> <span class="nf">SetInputData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For better compatibility with vtk methods style</span>

<span class="sd">        Args:</span>
<span class="sd">            input_data (vtkDataObject) : Object whose outline we want</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="OrientationAxes"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.OrientationAxes">[docs]</a><span class="k">class</span> <span class="nc">OrientationAxes</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An orientation cube with faces labeled for Right, Left, Anterior, Posterior, Superior and Inferior</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">axes_actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkAnnotatedCubeActor</span><span class="p">()</span>
        <span class="n">axes_actor</span><span class="o">.</span><span class="n">SetXPlusFaceText</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">)</span>
        <span class="n">axes_actor</span><span class="o">.</span><span class="n">SetXMinusFaceText</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">)</span>
        <span class="n">axes_actor</span><span class="o">.</span><span class="n">SetYPlusFaceText</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
        <span class="n">axes_actor</span><span class="o">.</span><span class="n">SetYMinusFaceText</span><span class="p">(</span><span class="s2">&quot;P&quot;</span><span class="p">)</span>
        <span class="n">axes_actor</span><span class="o">.</span><span class="n">SetZPlusFaceText</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
        <span class="n">axes_actor</span><span class="o">.</span><span class="n">SetZMinusFaceText</span><span class="p">(</span><span class="s2">&quot;I&quot;</span><span class="p">)</span>

        <span class="n">axes_actor</span><span class="o">.</span><span class="n">GetTextEdgesProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">axes_actor</span><span class="o">.</span><span class="n">GetTextEdgesProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetLineWidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">axes_actor</span><span class="o">.</span><span class="n">GetCubeProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>

        <span class="n">axes</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkOrientationMarkerWidget</span><span class="p">()</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">SetOrientationMarker</span><span class="p">(</span><span class="n">axes_actor</span><span class="p">)</span>
        <span class="n">axes</span><span class="o">.</span><span class="n">SetViewport</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span>

<div class="viewcode-block" id="OrientationAxes.initialize"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.OrientationAxes.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">render_window_interactor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Link the orientation cube with an interactor</span>

<span class="sd">        render_window_interactor (vtkRenderWindowInteractor) : vtk interactor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">SetInteractor</span><span class="p">(</span><span class="n">render_window_interactor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">EnabledOn</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">InteractiveOn</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="get_arrow"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.get_arrow">[docs]</a><span class="k">def</span> <span class="nf">get_arrow</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    create a polydata arrow, consider using vtkArrowSource</span>

<span class="sd">    Args:</span>
<span class="sd">        head (tuple) : coordinates for arrow head</span>
<span class="sd">        tail (tuple) : coordinates for arrow tail</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">arrow_pd</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">points_array</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
    <span class="n">triangle_array</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>
    <span class="n">line_array</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>
    <span class="n">arrow_points</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arrow_points</span><span class="p">):</span>
        <span class="n">points_array</span><span class="o">.</span><span class="n">InsertPoint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="n">triangle_array</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">triangle_array</span><span class="o">.</span><span class="n">InsertCellPoint</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">line_array</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">line_array</span><span class="o">.</span><span class="n">InsertCellPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">line_array</span><span class="o">.</span><span class="n">InsertCellPoint</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">arrow_pd</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points_array</span><span class="p">)</span>
    <span class="n">arrow_pd</span><span class="o">.</span><span class="n">SetLines</span><span class="p">(</span><span class="n">line_array</span><span class="p">)</span>
    <span class="n">arrow_pd</span><span class="o">.</span><span class="n">SetPolys</span><span class="p">(</span><span class="n">triangle_array</span><span class="p">)</span>

    <span class="c1">#---adjust to tail and head</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTransform</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">PostMultiply</span><span class="p">()</span>
    <span class="n">head</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
    <span class="n">tail</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">head</span> <span class="o">-</span> <span class="n">tail</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">rot_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">head</span> <span class="o">-</span> <span class="n">tail</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">rot_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rot_axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">length</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">rot_angle</span><span class="p">):</span>  <span class="c1"># handles legendary rounding errors</span>
            <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;please check output closely&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">((</span><span class="n">head</span> <span class="o">-</span> <span class="n">tail</span><span class="p">)</span> <span class="o">/</span> <span class="n">length</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">:</span>
                <span class="n">rot_angle</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rot_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="n">deg_angle</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">rot_angle</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">head</span> <span class="o">-</span> <span class="n">tail</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">deg_angle</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">-</span> <span class="n">deg_angle</span>
        <span class="n">t</span><span class="o">.</span><span class="n">RotateWXYZ</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">deg_angle</span><span class="p">,</span> <span class="n">rot_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rot_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rot_axis</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="n">t</span><span class="o">.</span><span class="n">Translate</span><span class="p">(</span><span class="o">*</span><span class="n">head</span><span class="p">)</span>
    <span class="n">transfor_filter</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkTransformPolyDataFilter</span><span class="p">()</span>
    <span class="n">transfor_filter</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">arrow_pd</span><span class="p">)</span>
    <span class="n">transfor_filter</span><span class="o">.</span><span class="n">SetTransform</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">transfor_filter</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">transfor_filter</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">fibers_balloon_message</span><span class="p">(</span><span class="n">fib_actor</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets a standard message for fiber bundle balloons</span>
<span class="sd">    This message contains the number of fibers in the bundle,</span>
<span class="sd">    their mean length, max length, min length, and standard deviation of length&quot;&quot;&quot;</span>
    <span class="n">mapper</span> <span class="o">=</span> <span class="n">fib_actor</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">fib</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No fibers available&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;No fibers available&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">get_fiber_bundle_descriptors</span><span class="p">(</span><span class="n">fib</span><span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Number of fibers: </span><span class="si">%d</span><span class="s2"></span>
<span class="s2">Mean Length (mm) : </span><span class="si">%.2f</span><span class="s2"></span>
<span class="s2">    Max: </span><span class="si">%.2f</span><span class="s2"></span>
<span class="s2">    Min: </span><span class="si">%.2f</span><span class="s2"></span>
<span class="s2">    Std: </span><span class="si">%.2f</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">d</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">message</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Fiber Bundle</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">message</span>
    <span class="k">return</span> <span class="n">message</span>


<div class="viewcode-block" id="cursors"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.cursors">[docs]</a><span class="k">class</span> <span class="nc">cursors</span><span class="p">(</span><span class="n">vtk</span><span class="o">.</span><span class="n">vtkPropAssembly</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Emulates the cursors in vtkImagePlaneWidget</span>

<span class="sd">    There will be two copies of the cursors polydata, one in front and one at the back of the</span>
<span class="sd">    image plane, the separation between them is controlled by the :meth:`set_delta` method</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The perpendicular axis is x:0 , y:1, z:2</span>

<span class="sd">        Notice that for the cursor to work properly the spacing, dimensions and origin</span>
<span class="sd">        of the underlying image must be set&quot;&quot;&quot;</span>
        <span class="n">actor_delta</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Space within the cursor and the image, notice there are cursors on both sides</span>
        <span class="n">cursor_x</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkLineSource</span><span class="p">()</span>
        <span class="n">cursor_x_mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">cursor_x_mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">cursor_x</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">cursor_x_actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">cursor_x_actor2</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">cursor_x_actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">cursor_x_mapper</span><span class="p">)</span>
        <span class="n">cursor_x_actor2</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">cursor_x_mapper</span><span class="p">)</span>

        <span class="n">cursor_y</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkLineSource</span><span class="p">()</span>
        <span class="n">cursor_y_mapper</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyDataMapper</span><span class="p">()</span>
        <span class="n">cursor_y_mapper</span><span class="o">.</span><span class="n">SetInputConnection</span><span class="p">(</span><span class="n">cursor_y</span><span class="o">.</span><span class="n">GetOutputPort</span><span class="p">())</span>
        <span class="n">cursor_y_actor</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">cursor_y_actor2</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkActor</span><span class="p">()</span>
        <span class="n">cursor_y_actor</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">cursor_y_mapper</span><span class="p">)</span>
        <span class="n">cursor_y_actor2</span><span class="o">.</span><span class="n">SetMapper</span><span class="p">(</span><span class="n">cursor_y_mapper</span><span class="p">)</span>

        <span class="n">actors_spacing1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">actors_spacing2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">actors_spacing1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">actor_delta</span>
        <span class="n">actors_spacing2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">actor_delta</span>

        <span class="n">cursor_x_actor</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">actors_spacing1</span><span class="p">)</span>
        <span class="n">cursor_x_actor2</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">actors_spacing2</span><span class="p">)</span>

        <span class="n">cursor_y_actor</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">actors_spacing1</span><span class="p">)</span>
        <span class="n">cursor_y_actor2</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">actors_spacing2</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">act</span> <span class="ow">in</span> <span class="p">[</span><span class="n">cursor_x_actor</span><span class="p">,</span> <span class="n">cursor_x_actor2</span><span class="p">,</span> <span class="n">cursor_y_actor</span><span class="p">,</span> <span class="n">cursor_y_actor2</span><span class="p">]:</span>
            <span class="n">act</span><span class="o">.</span><span class="n">GetProperty</span><span class="p">()</span><span class="o">.</span><span class="n">SetColor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AddPart</span><span class="p">(</span><span class="n">act</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="n">actor_delta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cursor_x</span> <span class="o">=</span> <span class="n">cursor_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cursor_y</span> <span class="o">=</span> <span class="n">cursor_y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">68</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actor_x1</span> <span class="o">=</span> <span class="n">cursor_x_actor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actor_x2</span> <span class="o">=</span> <span class="n">cursor_x_actor2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actor_y1</span> <span class="o">=</span> <span class="n">cursor_y_actor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actor_y2</span> <span class="o">=</span> <span class="n">cursor_y_actor2</span>

<div class="viewcode-block" id="cursors.set_spacing"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.cursors.set_spacing">[docs]</a>    <span class="k">def</span> <span class="nf">set_spacing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the spacing of the underlying image</span>

<span class="sd">        Args:</span>
<span class="sd">            dx (float) : x spacing</span>
<span class="sd">            dy (float) : y spacing</span>
<span class="sd">            dz (float) : z spacing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span></div>

<div class="viewcode-block" id="cursors.set_dimensions"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.cursors.set_dimensions">[docs]</a>    <span class="k">def</span> <span class="nf">set_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the dimensions of the underlying image</span>

<span class="sd">        Args:</span>
<span class="sd">            nx (float) : x dimension</span>
<span class="sd">            ny (float) : y dimension</span>
<span class="sd">            nz (float) : z dimension</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">=</span> <span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span><span class="p">)</span></div>

<div class="viewcode-block" id="cursors.set_origin"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.cursors.set_origin">[docs]</a>    <span class="k">def</span> <span class="nf">set_origin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the origin of the underlying image</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float) : x origin</span>
<span class="sd">            y (float) : y origin</span>
<span class="sd">            z (float) : z origin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span></div>

<div class="viewcode-block" id="cursors.set_cursor"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.cursors.set_cursor">[docs]</a>    <span class="k">def</span> <span class="nf">set_cursor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the position of the cursor</span>

<span class="sd">        Args:</span>
<span class="sd">            x (float) : x position</span>
<span class="sd">            y (float) : y position</span>
<span class="sd">            z (float) : z position</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># current_slice=slice_mapper.GetSliceNumber()</span>
        <span class="c1"># Attention to change in variables, now XY define the plane</span>
        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spacing</span>
        <span class="n">ox</span><span class="p">,</span> <span class="n">oy</span><span class="p">,</span> <span class="n">oz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_x</span><span class="o">.</span><span class="n">SetPoint1</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_x</span><span class="o">.</span><span class="n">SetPoint2</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="n">nz</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_y</span><span class="o">.</span><span class="n">SetPoint1</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_y</span><span class="o">.</span><span class="n">SetPoint2</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">ny</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_x</span><span class="o">.</span><span class="n">SetPoint1</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_x</span><span class="o">.</span><span class="n">SetPoint2</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="n">nz</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_y</span><span class="o">.</span><span class="n">SetPoint1</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_y</span><span class="o">.</span><span class="n">SetPoint2</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">nx</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_x</span><span class="o">.</span><span class="n">SetPoint1</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_x</span><span class="o">.</span><span class="n">SetPoint2</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">nx</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_y</span><span class="o">.</span><span class="n">SetPoint1</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cursor_y</span><span class="o">.</span><span class="n">SetPoint2</span><span class="p">((</span><span class="n">ox</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">oy</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">ny</span><span class="p">,</span> <span class="n">oz</span> <span class="o">+</span> <span class="n">dz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span></div>

<div class="viewcode-block" id="cursors.change_axis"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.cursors.change_axis">[docs]</a>    <span class="k">def</span> <span class="nf">change_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the axis perpendicular to the image plane</span>

<span class="sd">        Args:</span>
<span class="sd">            axis (int) :   x:0 , y:1, z:2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>
        <span class="n">actors_spacing1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">actors_spacing2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">actors_spacing1</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span>
        <span class="n">actors_spacing2</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actor_x1</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">actors_spacing1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actor_y1</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">actors_spacing1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actor_x2</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">actors_spacing2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actor_y2</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">actors_spacing2</span><span class="p">)</span></div>

<div class="viewcode-block" id="cursors.set_delta"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.cursors.set_delta">[docs]</a>    <span class="k">def</span> <span class="nf">set_delta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets separation between front and back cursors.</span>

<span class="sd">        Args:</span>
<span class="sd">            delta (float) :  Separation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span></div></div>


<div class="viewcode-block" id="build_grid"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.build_grid">[docs]</a><span class="k">def</span> <span class="nf">build_grid</span><span class="p">(</span><span class="n">orig_img</span><span class="p">,</span> <span class="n">img_slice</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates an homogenous grid, useful for showing the effects of transformations</span>

<span class="sd">    The grid dimensions are based on the orig_img, img_slice is used to position the grid along the x axis,</span>
<span class="sd">    For the moment only grids perpendicular to the x axis are available</span>

<span class="sd">    Args:</span>
<span class="sd">        orig_img (vtkImageData) : Image to base grid on</span>
<span class="sd">        img_slice (int) : Slice of the image where the grid will be located (along the x asis)</span>
<span class="sd">        sampling_rate (int) : Density of the grid, there will be a line each *sampling_rate* voxels</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dimensions</span> <span class="o">=</span> <span class="n">orig_img</span><span class="o">.</span><span class="n">GetDimensions</span><span class="p">()</span>
    <span class="n">spacing</span> <span class="o">=</span> <span class="n">orig_img</span><span class="o">.</span><span class="n">GetSpacing</span><span class="p">()</span>
    <span class="n">origin</span> <span class="o">=</span> <span class="n">orig_img</span><span class="o">.</span><span class="n">GetOrigin</span><span class="p">()</span>
    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">img2world</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="o">*</span> <span class="n">spacing</span> <span class="o">+</span> <span class="n">origin</span>

    <span class="k">def</span> <span class="nf">flat_index</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">j</span> <span class="o">*</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span>

    <span class="n">points</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPoints</span><span class="p">()</span>
    <span class="n">points</span><span class="o">.</span><span class="n">SetNumberOfPoints</span><span class="p">(</span><span class="n">n_points</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">flat_index</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="n">img2world</span><span class="p">(</span><span class="n">img_slice</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
            <span class="n">points</span><span class="o">.</span><span class="n">SetPoint</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkPolyData</span><span class="p">()</span>
    <span class="n">grid</span><span class="o">.</span><span class="n">SetPoints</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCellArray</span><span class="p">()</span>
    <span class="c1"># vertical:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">%</span> <span class="n">sampling_rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">InsertCellPoint</span><span class="p">(</span><span class="n">flat_index</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
    <span class="c1"># horizontal</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="n">sampling_rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">InsertNextCell</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">InsertCellPoint</span><span class="p">(</span><span class="n">flat_index</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>

    <span class="n">grid</span><span class="o">.</span><span class="n">SetLines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="n">cleaner</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkCleanPolyData</span><span class="p">()</span>
    <span class="n">cleaner</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
    <span class="n">cleaner</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
    <span class="n">clean_grid</span> <span class="o">=</span> <span class="n">cleaner</span><span class="o">.</span><span class="n">GetOutput</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">clean_grid</span></div>


<span class="k">def</span> <span class="nf">add_solid_balloon</span><span class="p">(</span><span class="n">balloon_widget</span><span class="p">,</span> <span class="n">solid_actor</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">my_volume</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a standard balloon for models</span>

<span class="sd">    This standard balloon will contain the solid name(if given), its volume and its surface area</span>
<span class="sd">    my_volume can be specified to replace the auto calculated volume</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mapper</span> <span class="o">=</span> <span class="n">solid_actor</span><span class="o">.</span><span class="n">GetMapper</span><span class="p">()</span>
    <span class="n">poly_data</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="n">GetInput</span><span class="p">()</span>
    <span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">area</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_volume_and_area</span><span class="p">(</span><span class="n">poly_data</span><span class="p">)</span>
    <span class="c1">#message = &quot;Volume = %.2f mm3 \nSurface Area = %.2f mm2 &quot; % (volume, area)</span>
    <span class="k">if</span> <span class="n">my_volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">volume</span> <span class="o">=</span> <span class="n">my_volume</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Volume* = </span><span class="si">%.2f</span><span class="s2"> mm3 </span><span class="se">\n</span><span class="s2">Surface Area = </span><span class="si">%.2f</span><span class="s2"> mm2 &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">area</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="n">balloon_widget</span><span class="o">.</span><span class="n">AddBalloon</span><span class="p">(</span><span class="n">solid_actor</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="k">return</span>


<span class="k">def</span> <span class="nf">add_simple_solid_balloon</span><span class="p">(</span><span class="n">balloon_widget</span><span class="p">,</span> <span class="n">solid_actor</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;YOYIS Adds a standard balloon with a custom message&quot;&quot;&quot;</span>
    <span class="n">balloon_widget</span><span class="o">.</span><span class="n">AddBalloon</span><span class="p">(</span><span class="n">solid_actor</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="k">return</span>


<span class="k">def</span> <span class="nf">add_fibers_balloon</span><span class="p">(</span><span class="n">balloon_widget</span><span class="p">,</span> <span class="n">fib_actor</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a standard balloon for fiber bundles, the message contains the name, the number of fibers</span>
<span class="sd">    and descriptors about the length of the fibers (see fibers_balloon_message)&quot;&quot;&quot;</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">fibers_balloon_message</span><span class="p">(</span><span class="n">fib_actor</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">balloon_widget</span><span class="o">.</span><span class="n">AddBalloon</span><span class="p">(</span><span class="n">fib_actor</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>


<div class="viewcode-block" id="get_window_level"><a class="viewcode-back" href="../../../library/simple_vtk.html#braviz.visualization.simple_vtk.get_window_level">[docs]</a><span class="k">def</span> <span class="nf">get_window_level</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Automatically gets appropriate window and level values for displaying an image</span>

<span class="sd">    Args:</span>
<span class="sd">        img (vtkImageData) : Image</span>

<span class="sd">    Returns</span>
<span class="sd">        (window,level), proposed values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">vtk</span><span class="o">.</span><span class="n">vtkImageHistogramStatistics</span><span class="p">()</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">SetInputData</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">GetAutoRange</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">w</span> <span class="o">/</span> <span class="mi">2</span></div>
</pre></div>

          </div>
        </div>
      </div>
        </div>

        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          
                

                

                

          
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Diego Angulo.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>







        
  </body>
</html>